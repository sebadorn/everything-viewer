"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[6161],{86161:(e,r,a)=>{a.d(r,{KHR_materials_specular:()=>i});var l=a(23975),t=a(98556),s=a(26041),o=a(96125),c=a(37812);const n="KHR_materials_specular";class i{constructor(e){this.name=n,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(n)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,r,a){return t.BT.LoadExtensionAsync(e,r,this.name,async(t,s)=>{const c=new Array;if(c.push(this._loader.loadMaterialPropertiesAsync(e,r,a)),c.push(this._loadSpecularPropertiesAsync(t,s,a)),s.extensions&&s.extensions.EXT_materials_specular_edge_color&&a instanceof l.Y){s.extensions.EXT_materials_specular_edge_color.specularEdgeColorEnabled&&(a.brdf.dielectricSpecularModel=o.Y.MATERIAL_DIELECTRIC_SPECULAR_MODEL_OPENPBR,a.brdf.conductorSpecularModel=o.Y.MATERIAL_CONDUCTOR_SPECULAR_MODEL_OPENPBR)}return await Promise.all(c).then(()=>{})})}_loadSpecularPropertiesAsync(e,r,a){if(!(a instanceof l.Y))throw new Error(`${e}: Material type not supported`);const t=new Array;return void 0!==r.specularFactor&&(a.metallicF0Factor=r.specularFactor),void 0!==r.specularColorFactor&&(a.metallicReflectanceColor=s.v9.FromArray(r.specularColorFactor)),r.specularTexture&&(r.specularTexture.nonColorData=!0,t.push(this._loader.loadTextureInfoAsync(`${e}/specularTexture`,r.specularTexture,e=>{e.name=`${a.name} (Specular)`,a.metallicReflectanceTexture=e,a.useOnlyMetallicFromMetallicReflectanceTexture=!0}))),r.specularColorTexture&&t.push(this._loader.loadTextureInfoAsync(`${e}/specularColorTexture`,r.specularColorTexture,e=>{e.name=`${a.name} (Specular Color)`,a.reflectanceTexture=e})),Promise.all(t).then(()=>{})}}(0,c.Hg)(n),(0,c.Ye)(n,!0,e=>new i(e))}}]);