"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[1784,4236],{1784:(e,t,s)=>{s.d(t,{KHR_animation_pointer:()=>L});var n=s(51137),r=s(37812),a=s(49532),i=s(7540),o=s(34236),l=s(26041);function m(e,t,s,n){return l.v9.FromArray(t,s).scale(n)}function c(e,t,s,n){return t[s]*n}function _(e,t,s,n){return-t[s]*n}function u(e,t,s,n){return t[s+1]*n}function x(e,t,s,n){return t[s]*n*2}function T(e){return{scale:[new A(i.X5.ANIMATIONTYPE_FLOAT,`${e}.uScale`,c,()=>2),new A(i.X5.ANIMATIONTYPE_FLOAT,`${e}.vScale`,u,()=>2)],offset:[new A(i.X5.ANIMATIONTYPE_FLOAT,`${e}.uOffset`,c,()=>2),new A(i.X5.ANIMATIONTYPE_FLOAT,`${e}.vOffset`,u,()=>2)],rotation:[new A(i.X5.ANIMATIONTYPE_FLOAT,`${e}.wAng`,_,()=>1)]}}class f extends o.AnimationPropertyInfo{buildAnimations(e,t,s,n){return[{babylonAnimatable:e._babylonCamera,babylonAnimation:this._buildAnimation(t,s,n)}]}}class A extends o.AnimationPropertyInfo{buildAnimations(e,t,s,n){const r=[];for(const a in e._data)r.push({babylonAnimatable:e._data[a].babylonMaterial,babylonAnimation:this._buildAnimation(t,s,n)});return r}}class R extends o.AnimationPropertyInfo{buildAnimations(e,t,s,n){return[{babylonAnimatable:e._babylonLight,babylonAnimation:this._buildAnimation(t,s,n)}]}}(0,a.ZU)("/cameras/{}/orthographic/xmag",[new f(i.X5.ANIMATIONTYPE_FLOAT,"orthoLeft",_,()=>1),new f(i.X5.ANIMATIONTYPE_FLOAT,"orthoRight",u,()=>1)]),(0,a.ZU)("/cameras/{}/orthographic/ymag",[new f(i.X5.ANIMATIONTYPE_FLOAT,"orthoBottom",_,()=>1),new f(i.X5.ANIMATIONTYPE_FLOAT,"orthoTop",u,()=>1)]),(0,a.ZU)("/cameras/{}/orthographic/zfar",[new f(i.X5.ANIMATIONTYPE_FLOAT,"maxZ",c,()=>1)]),(0,a.ZU)("/cameras/{}/orthographic/znear",[new f(i.X5.ANIMATIONTYPE_FLOAT,"minZ",c,()=>1)]),(0,a.ZU)("/cameras/{}/perspective/yfov",[new f(i.X5.ANIMATIONTYPE_FLOAT,"fov",c,()=>1)]),(0,a.ZU)("/cameras/{}/perspective/zfar",[new f(i.X5.ANIMATIONTYPE_FLOAT,"maxZ",c,()=>1)]),(0,a.ZU)("/cameras/{}/perspective/znear",[new f(i.X5.ANIMATIONTYPE_FLOAT,"minZ",c,()=>1)]),(0,a.ZU)("/materials/{}/pbrMetallicRoughness/baseColorFactor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"albedoColor",m,()=>4),new A(i.X5.ANIMATIONTYPE_FLOAT,"alpha",function(e,t,s,n){return t[s+3]*n},()=>4)]),(0,a.ZU)("/materials/{}/pbrMetallicRoughness/metallicFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"metallic",c,()=>1)]),(0,a.ZU)("/materials/{}/pbrMetallicRoughness/metallicFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"roughness",c,()=>1)]);const h=T("albedoTexture");(0,a.ZU)("/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/scale",h.scale),(0,a.ZU)("/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/offset",h.offset),(0,a.ZU)("/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/rotation",h.rotation);const K=T("metallicTexture");(0,a.ZU)("//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/scale",K.scale),(0,a.ZU)("//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/offset",K.offset),(0,a.ZU)("//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/rotation",K.rotation),(0,a.ZU)("/materials/{}/emissiveFactor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"emissiveColor",m,()=>3)]);const H=T("bumpTexture");(0,a.ZU)("/materials/{}/normalTexture/scale",[new A(i.X5.ANIMATIONTYPE_FLOAT,"bumpTexture.level",c,()=>1)]),(0,a.ZU)("/materials/{}/normalTexture/extensions/KHR_texture_transform/scale",H.scale),(0,a.ZU)("/materials/{}/normalTexture/extensions/KHR_texture_transform/offset",H.offset),(0,a.ZU)("/materials/{}/normalTexture/extensions/KHR_texture_transform/rotation",H.rotation),(0,a.ZU)("/materials/{}/occlusionTexture/strength",[new A(i.X5.ANIMATIONTYPE_FLOAT,"ambientTextureStrength",c,()=>1)]);const I=T("ambientTexture");(0,a.ZU)("/materials/{}/occlusionTexture/extensions/KHR_texture_transform/scale",I.scale),(0,a.ZU)("/materials/{}/occlusionTexture/extensions/KHR_texture_transform/offset",I.offset),(0,a.ZU)("/materials/{}/occlusionTexture/extensions/KHR_texture_transform/rotation",I.rotation);const O=T("emissiveTexture");(0,a.ZU)("/materials/{}/emissiveTexture/extensions/KHR_texture_transform/scale",O.scale),(0,a.ZU)("/materials/{}/emissiveTexture/extensions/KHR_texture_transform/offset",O.offset),(0,a.ZU)("/materials/{}/emissiveTexture/extensions/KHR_texture_transform/rotation",O.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_anisotropy/anisotropyStrength",[new A(i.X5.ANIMATIONTYPE_FLOAT,"anisotropy.intensity",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_anisotropy/anisotropyRotation",[new A(i.X5.ANIMATIONTYPE_FLOAT,"anisotropy.angle",c,()=>1)]);const p=T("anisotropy.texture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/scale",p.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/offset",p.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/rotation",p.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"clearCoat.intensity",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"clearCoat.roughness",c,()=>1)]);const N=T("clearCoat.texture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/scale",N.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/offset",N.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/rotation",N.rotation);const Z=T("clearCoat.bumpTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/scale",[new A(i.X5.ANIMATIONTYPE_FLOAT,"clearCoat.bumpTexture.level",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/scale",Z.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/offset",Z.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/rotation",Z.rotation);const U=T("clearCoat.textureRoughness");(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/scale",U.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/offset",U.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/rotation",U.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_dispersion/dispersionFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"subSurface.dispersion",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_emissive_strength/emissiveStrength",[new A(i.X5.ANIMATIONTYPE_FLOAT,"emissiveIntensity",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_ior/ior",[new A(i.X5.ANIMATIONTYPE_FLOAT,"indexOfRefraction",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"iridescence.intensity",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceIor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"iridescence.indexOfRefraction",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessMinimum",[new A(i.X5.ANIMATIONTYPE_FLOAT,"iridescence.minimumThickness",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessMaximum",[new A(i.X5.ANIMATIONTYPE_FLOAT,"iridescence.maximumThickness",c,()=>1)]);const g=T("iridescence.texture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/scale",g.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/offset",g.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/rotation",g.rotation);const d=T("iridescence.thicknessTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/scale",d.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/offset",d.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/rotation",d.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenColorFactor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"sheen.color",m,()=>3)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"sheen.roughness",c,()=>1)]);const b=T("sheen.texture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/scale",b.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/offset",b.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/rotation",b.rotation);const M=T("sheen.textureRoughness");(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/scale",M.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/offset",M.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/rotation",M.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"metallicF0Factor",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularColorFactor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"metallicReflectanceColor",m,()=>3)]);const w=T("metallicReflectanceTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/scale",w.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/offset",w.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/rotation",w.rotation);const y=T("reflectanceTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/scale",y.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/offset",y.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/rotation",y.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_transmission/transmissionFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"subSurface.refractionIntensity",c,()=>1)]);const F=T("subSurface.refractionIntensityTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/scale",F.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/offset",F.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/rotation",F.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/attenuationColor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"subSurface.tintColor",m,()=>3)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/attenuationDistance",[new A(i.X5.ANIMATIONTYPE_FLOAT,"subSurface.tintColorAtDistance",c,()=>1)]),(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/thicknessFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"subSurface.maximumThickness",c,()=>1)]);const P=T("subSurface.thicknessTexture");(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/scale",P.scale),(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/offset",P.offset),(0,a.ZU)("/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/rotation",P.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionFactor",[new A(i.X5.ANIMATIONTYPE_FLOAT,"subSurface.translucencyIntensity",c,()=>1)]);const E=T("subSurface.translucencyIntensityTexture");(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/scale",E.scale),(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/offset",E.offset),(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/rotation",E.rotation),(0,a.ZU)("/materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorFactor",[new A(i.X5.ANIMATIONTYPE_COLOR3,"subSurface.translucencyColor",m,()=>3)]);const X=T("subSurface.translucencyColorTexture");(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/scale",X.scale),(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/offset",X.offset),(0,a.ZU)("materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/rotation",X.rotation),(0,a.ZU)("/extensions/KHR_lights_punctual/lights/{}/color",[new R(i.X5.ANIMATIONTYPE_COLOR3,"diffuse",m,()=>3)]),(0,a.ZU)("/extensions/KHR_lights_punctual/lights/{}/intensity",[new R(i.X5.ANIMATIONTYPE_FLOAT,"intensity",c,()=>1)]),(0,a.ZU)("/extensions/KHR_lights_punctual/lights/{}/range",[new R(i.X5.ANIMATIONTYPE_FLOAT,"range",c,()=>1)]),(0,a.ZU)("/extensions/KHR_lights_punctual/lights/{}/spot/innerConeAngle",[new R(i.X5.ANIMATIONTYPE_FLOAT,"innerAngle",x,()=>1)]),(0,a.ZU)("/extensions/KHR_lights_punctual/lights/{}/spot/outerConeAngle",[new R(i.X5.ANIMATIONTYPE_FLOAT,"angle",x,()=>1)]),(0,a.ZU)("/nodes/{}/extensions/EXT_lights_ies/color",[new R(i.X5.ANIMATIONTYPE_COLOR3,"diffuse",m,()=>3)]),(0,a.ZU)("/nodes/{}/extensions/EXT_lights_ies/multiplier",[new R(i.X5.ANIMATIONTYPE_FLOAT,"intensity",c,()=>1)]);const Y="KHR_animation_pointer";class L{constructor(e){this.name=Y,this._loader=e,this._pathToObjectConverter=(0,a.Wt)(this._loader.gltf)}get enabled(){return this._loader.isExtensionUsed(Y)}dispose(){this._loader=null,delete this._pathToObjectConverter}_loadAnimationChannelAsync(e,t,s,r,a){const i=r.target.extensions?.KHR_animation_pointer;if(!i||!this._pathToObjectConverter)return null;"pointer"!==r.target.path&&n.V.Warn(`${e}/target/path: Value (${r.target.path}) must be (pointer) when using the ${this.name} extension`),null!=r.target.node&&n.V.Warn(`${e}/target/node: Value (${r.target.node}) must not be present when using the ${this.name} extension`);const o=`${e}/extensions/${this.name}`,l=i.pointer;if(!l)throw new Error(`${o}: Pointer is missing`);try{const n=this._pathToObjectConverter.convert(l);if(!n.info.interpolation)throw new Error(`${o}/pointer: Interpolation is missing`);return this._loader._loadAnimationChannelFromTargetInfoAsync(e,t,s,r,{object:n.object,info:n.info.interpolation},a)}catch(e){return n.V.Warn(`${o}/pointer: Invalid pointer (${l}) skipped`),null}}}(0,r.Hg)(Y),(0,r.Ye)(Y,!0,e=>new L(e))},34236:(e,t,s)=>{s.r(t),s.d(t,{AnimationPropertyInfo:()=>m,TransformNodeAnimationPropertyInfo:()=>c,WeightAnimationPropertyInfo:()=>_,getQuaternion:()=>o,getVector3:()=>i,getWeights:()=>l});var n=s(7540),r=s(79923),a=s(49532);function i(e,t,s,n){return r.Pq.FromArray(t,s).scaleInPlace(n)}function o(e,t,s,n){return r.PT.FromArray(t,s).scaleInPlace(n)}function l(e,t,s,n){const r=new Array(e._numMorphTargets);for(let e=0;e<r.length;e++)r[e]=t[s++]*n;return r}class m{constructor(e,t,s,n){this.type=e,this.name=t,this.getValue=s,this.getStride=n}_buildAnimation(e,t,s){const r=new n.X5(e,this.name,t,this.type);return r.setKeys(s),r}}class c extends m{buildAnimations(e,t,s,n){const r=[];return r.push({babylonAnimatable:e._babylonTransformNode,babylonAnimation:this._buildAnimation(t,s,n)}),r}}class _ extends m{buildAnimations(e,t,s,r){const a=[];if(e._numMorphTargets)for(let i=0;i<e._numMorphTargets;i++){const o=new n.X5(`${t}_${i}`,this.name,s,this.type);if(o.setKeys(r.map(e=>({frame:e.frame,inTangent:e.inTangent?e.inTangent[i]:void 0,value:e.value[i],outTangent:e.outTangent?e.outTangent[i]:void 0,interpolation:e.interpolation}))),e._primitiveBabylonMeshes)for(const t of e._primitiveBabylonMeshes)if(t.morphTargetManager){const e=t.morphTargetManager.getTarget(i),s=o.clone();e.animations.push(s),a.push({babylonAnimatable:e,babylonAnimation:s})}}return a}}(0,a.ZU)("/nodes/{}/translation",[new c(n.X5.ANIMATIONTYPE_VECTOR3,"position",i,()=>3)]),(0,a.ZU)("/nodes/{}/rotation",[new c(n.X5.ANIMATIONTYPE_QUATERNION,"rotationQuaternion",o,()=>4)]),(0,a.ZU)("/nodes/{}/scale",[new c(n.X5.ANIMATIONTYPE_VECTOR3,"scaling",i,()=>3)]),(0,a.ZU)("/nodes/{}/weights",[new _(n.X5.ANIMATIONTYPE_FLOAT,"influence",l,e=>e._numMorphTargets)])}}]);