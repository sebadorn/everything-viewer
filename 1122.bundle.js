"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[1122],{63318:(t,e,o)=>{o.d(e,{a:()=>a});var s=o(94423);class a extends s.r{constructor(t,e,o,s,a){super(e,a),this._operation=o,this._className=s,this.a=this.registerDataInput("a",t)}_doOperation(t){return this._operation(this.a.getValue(t))}getClassName(){return this._className}}},77467:(t,e,o)=>{o.d(e,{W:()=>a});var s=o(94423);class a extends s.r{constructor(t,e,o,s,a,r){super(o,r),this._operation=s,this._className=a,this.a=this.registerDataInput("a",t),this.b=this.registerDataInput("b",e)}_doOperation(t){const e=this.a.getValue(t),o=this.b.getValue(t);return this._operation(e,o)}getClassName(){return this._className}}},91122:(t,e,o)=>{o.r(e),o.d(e,{FlowGraphAngleBetweenBlock:()=>f,FlowGraphAxisAngleFromQuaternionBlock:()=>C,FlowGraphConjugateBlock:()=>D,FlowGraphCrossBlock:()=>g,FlowGraphDotBlock:()=>m,FlowGraphLengthBlock:()=>d,FlowGraphNormalizeBlock:()=>V,FlowGraphQuaternionFromAxisAngleBlock:()=>v,FlowGraphQuaternionFromDirectionsBlock:()=>A,FlowGraphRotate2DBlock:()=>F,FlowGraphRotate3DBlock:()=>k,FlowGraphTransformBlock:()=>_,FlowGraphTransformCoordinatesBlock:()=>G});var s=o(42851),a=o(4720),r=o(56552),l=o(77467),n=o(63318),i=o(14037),c=o(4686),u=o(84867);function h(t,e){const o=new i.PT;return function(t,e,o){const s=i.Pq.Cross(t,e),a=Math.acos((0,u.Clamp)(i.Pq.Dot(t,e),-1,1));i.PT.RotationAxisToRef(s,a,o)}(t,e,o),o}const p="cachedOperationAxis",x="cachedOperationAngle",w="cachedExecutionId";class d extends n.a{constructor(t){super(a.Vv,a.Es,t=>this._polymorphicLength(t),"FlowGraphLengthBlock",t)}_polymorphicLength(t){switch((0,c.I$)(t)){case"Vector2":case"Vector3":case"Vector4":case"Quaternion":return t.length();default:throw new Error(`Cannot compute length of value ${t}`)}}}(0,r.Y5)("FlowGraphLengthBlock",d);class V extends n.a{constructor(t){super(a.Vv,a.Vv,t=>this._polymorphicNormalize(t),"FlowGraphNormalizeBlock",t)}_polymorphicNormalize(t){let e;switch((0,c.I$)(t)){case"Vector2":case"Vector3":case"Vector4":case"Quaternion":if(e=t.normalizeToNew(),this.config?.nanOnZeroLength){0===t.length()&&e.setAll(NaN)}return e;default:throw new Error(`Cannot normalize value ${t}`)}}}(0,r.Y5)("FlowGraphNormalizeBlock",V);class m extends l.W{constructor(t){super(a.Vv,a.Vv,a.Es,(t,e)=>this._polymorphicDot(t,e),"FlowGraphDotBlock",t)}_polymorphicDot(t,e){switch((0,c.I$)(t)){case"Vector2":case"Vector3":case"Vector4":case"Quaternion":return t.dot(e);default:throw new Error(`Cannot get dot product of ${t} and ${e}`)}}}(0,r.Y5)("FlowGraphDotBlock",m);class g extends l.W{constructor(t){super(a.Dx,a.Dx,a.Dx,(t,e)=>i.Pq.Cross(t,e),"FlowGraphCrossBlock",t)}}(0,r.Y5)("FlowGraphCrossBlock",g);class F extends l.W{constructor(t){super(a.K$,a.Es,a.K$,(t,e)=>t.rotate(e),"FlowGraphRotate2DBlock",t)}}(0,r.Y5)("FlowGraphRotate2DBlock",F);class k extends l.W{constructor(t){super(a.Dx,a.P_,a.Dx,(t,e)=>t.applyRotationQuaternion(e),"FlowGraphRotate3DBlock",t)}}function B(t,e){switch((0,c.I$)(t)){case"Vector2":case"Vector3":return e.transformVector(t);case"Vector4":return new i.IU(t.x*e.m[0]+t.y*e.m[1]+t.z*e.m[2]+t.w*e.m[3],t.x*e.m[4]+t.y*e.m[5]+t.z*e.m[6]+t.w*e.m[7],t.x*e.m[8]+t.y*e.m[9]+t.z*e.m[10]+t.w*e.m[11],t.x*e.m[12]+t.y*e.m[13]+t.z*e.m[14]+t.w*e.m[15]);default:throw new Error(`Cannot transform value ${t}`)}}(0,r.Y5)("FlowGraphRotate3DBlock",k);class _ extends l.W{constructor(t){const e=t?.vectorType||"Vector3",o="Vector2"===e?"Matrix2D":"Vector3"===e?"Matrix3D":"Matrix";super((0,a.Yd)(e),(0,a.Yd)(o),(0,a.Yd)(e),B,"FlowGraphTransformVectorBlock",t)}}(0,r.Y5)("FlowGraphTransformVectorBlock",_);class G extends l.W{constructor(t){super(a.Dx,a.Sp,a.Dx,(t,e)=>i.Pq.TransformCoordinates(t,e),"FlowGraphTransformCoordinatesBlock",t)}}(0,r.Y5)("FlowGraphTransformCoordinatesBlock",G);class D extends n.a{constructor(t){super(a.P_,a.P_,t=>t.conjugate(),"FlowGraphConjugateBlock",t)}}(0,r.Y5)("FlowGraphConjugateBlock",D);class f extends l.W{constructor(t){super(a.P_,a.P_,a.Es,(t,e)=>{return o=t,s=e,2*Math.acos((0,u.Clamp)(i.PT.Dot(o,s)));var o,s},"FlowGraphAngleBetweenBlock",t)}}(0,r.Y5)("FlowGraphAngleBetweenBlock",f);class v extends l.W{constructor(t){super(a.Dx,a.Es,a.P_,(t,e)=>i.PT.RotationAxis(t,e),"FlowGraphQuaternionFromAxisAngleBlock",t)}}(0,r.Y5)("FlowGraphQuaternionFromAxisAngleBlock",v);class C extends s.e{constructor(t){super(t),this.a=this.registerDataInput("a",a.P_),this.axis=this.registerDataOutput("axis",a.Dx),this.angle=this.registerDataOutput("angle",a.Es),this.isValid=this.registerDataOutput("isValid",a.RI)}_updateOutputs(t){const e=t._getExecutionVariable(this,w,-1),o=t._getExecutionVariable(this,p,null),s=t._getExecutionVariable(this,x,null);if(null!=o&&null!=s&&e===t.executionId)this.axis.setValue(o,t),this.angle.setValue(s,t);else try{const{axis:e,angle:o}=this.a.getValue(t).toAxisAngle();t._setExecutionVariable(this,p,e),t._setExecutionVariable(this,x,o),t._setExecutionVariable(this,w,t.executionId),this.axis.setValue(e,t),this.angle.setValue(o,t),this.isValid.setValue(!0,t)}catch(e){this.isValid.setValue(!1,t)}}getClassName(){return"FlowGraphAxisAngleFromQuaternionBlock"}}(0,r.Y5)("FlowGraphAxisAngleFromQuaternionBlock",C);class A extends l.W{constructor(t){super(a.Dx,a.Dx,a.P_,(t,e)=>h(t,e),"FlowGraphQuaternionFromDirectionsBlock",t)}}},94423:(t,e,o)=>{o.d(e,{r:()=>n});var s=o(42851),a=o(4720);const r="cachedOperationValue",l="cachedExecutionId";class n extends s.e{constructor(t,e){super(e),this.value=this.registerDataOutput("value",t),this.isValid=this.registerDataOutput("isValid",a.RI)}_updateOutputs(t){const e=t._getExecutionVariable(this,l,-1),o=t._getExecutionVariable(this,r,null);if(null!=o&&e===t.executionId)this.isValid.setValue(!0,t),this.value.setValue(o,t);else try{const e=this._doOperation(t);if(null==e)return void this.isValid.setValue(!1,t);t._setExecutionVariable(this,r,e),t._setExecutionVariable(this,l,t.executionId),this.value.setValue(e,t),this.isValid.setValue(!0,t)}catch(e){this.isValid.setValue(!1,t)}}}}}]);