"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[3155],{53155:(s,e,r)=>{r.d(e,{KHR_materials_diffuse_transmission:()=>u});var n=r(23975),a=r(98556),i=r(26041),t=r(37812);const o="KHR_materials_diffuse_transmission";class u{constructor(s){this.name=o,this.order=174,this._loader=s,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&(s.parent.transparencyAsCoverage=!0)}dispose(){this._loader=null}loadMaterialPropertiesAsync(s,e,r){return a.BT.LoadExtensionAsync(s,e,this.name,async(n,a)=>{const i=new Array;return i.push(this._loader.loadMaterialPropertiesAsync(s,e,r)),i.push(this._loadTranslucentPropertiesAsync(n,e,r,a)),await Promise.all(i).then(()=>{})})}_loadTranslucentPropertiesAsync(s,e,r,a){if(!(r instanceof n.Y))throw new Error(`${s}: Material type not supported`);const t=r;if(t.subSurface.isTranslucencyEnabled=!0,t.subSurface.volumeIndexOfRefraction=1,t.subSurface.minimumThickness=0,t.subSurface.maximumThickness=0,t.subSurface.useAlbedoToTintTranslucency=!1,void 0===a.diffuseTransmissionFactor)return t.subSurface.translucencyIntensity=0,t.subSurface.isTranslucencyEnabled=!1,Promise.resolve();t.subSurface.translucencyIntensity=a.diffuseTransmissionFactor;const o=new Array;return t.subSurface.useGltfStyleTextures=!0,a.diffuseTransmissionTexture&&(a.diffuseTransmissionTexture.nonColorData=!0,o.push(this._loader.loadTextureInfoAsync(`${s}/diffuseTransmissionTexture`,a.diffuseTransmissionTexture).then(s=>{s.name=`${r.name} (Diffuse Transmission)`,t.subSurface.translucencyIntensityTexture=s}))),void 0!==a.diffuseTransmissionColorFactor?t.subSurface.translucencyColor=i.v9.FromArray(a.diffuseTransmissionColorFactor):t.subSurface.translucencyColor=i.v9.White(),a.diffuseTransmissionColorTexture&&o.push(this._loader.loadTextureInfoAsync(`${s}/diffuseTransmissionColorTexture`,a.diffuseTransmissionColorTexture).then(s=>{s.name=`${r.name} (Diffuse Transmission Color)`,t.subSurface.translucencyColorTexture=s})),Promise.all(o).then(()=>{})}}(0,t.Hg)(o),(0,t.Ye)(o,!0,s=>new u(s))}}]);