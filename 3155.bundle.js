"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[3155],{53155:(s,e,r)=>{r.d(e,{KHR_materials_diffuse_transmission:()=>u});var n=r(23975),i=r(45316),a=r(26041),o=r(37812);const t="KHR_materials_diffuse_transmission";class u{constructor(s){this.name=t,this.order=174,this._loader=s,this.enabled=this._loader.isExtensionUsed(t),this.enabled&&(s.parent.transparencyAsCoverage=!0)}dispose(){this._loader=null}loadMaterialPropertiesAsync(s,e,r){return i.BT.LoadExtensionAsync(s,e,this.name,((n,i)=>{const a=new Array;return a.push(this._loader.loadMaterialPropertiesAsync(s,e,r)),a.push(this._loadTranslucentPropertiesAsync(n,e,r,i)),Promise.all(a).then((()=>{}))}))}_loadTranslucentPropertiesAsync(s,e,r,i){if(!(r instanceof n.Y))throw new Error(`${s}: Material type not supported`);const o=r;if(o.subSurface.isTranslucencyEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.minimumThickness=0,o.subSurface.maximumThickness=0,o.subSurface.useAlbedoToTintTranslucency=!1,void 0===i.diffuseTransmissionFactor)return o.subSurface.translucencyIntensity=0,o.subSurface.isTranslucencyEnabled=!1,Promise.resolve();o.subSurface.translucencyIntensity=i.diffuseTransmissionFactor;const t=new Array;return o.subSurface.useGltfStyleTextures=!0,i.diffuseTransmissionTexture&&(i.diffuseTransmissionTexture.nonColorData=!0,t.push(this._loader.loadTextureInfoAsync(`${s}/diffuseTransmissionTexture`,i.diffuseTransmissionTexture).then((s=>{s.name=`${r.name} (Diffuse Transmission)`,o.subSurface.translucencyIntensityTexture=s})))),void 0!==i.diffuseTransmissionColorFactor?o.subSurface.translucencyColor=a.v9.FromArray(i.diffuseTransmissionColorFactor):o.subSurface.translucencyColor=a.v9.White(),i.diffuseTransmissionColorTexture&&t.push(this._loader.loadTextureInfoAsync(`${s}/diffuseTransmissionColorTexture`,i.diffuseTransmissionColorTexture).then((s=>{s.name=`${r.name} (Diffuse Transmission Color)`,o.subSurface.translucencyColorTexture=s}))),Promise.all(t).then((()=>{}))}}(0,o.Hg)(t),(0,o.Ye)(t,!0,(s=>new u(s)))}}]);