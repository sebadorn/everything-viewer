"use strict";(self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[]).push([[4353],{64353:(t,e,i)=>{i.r(e),i.d(e,{FlowGraphStopAnimationBlock:()=>r});var n=i(4720),o=i(56552),a=i(51137),s=i(51e3);class r extends s.M{constructor(t){super(t),this.animationGroup=this.registerDataInput("animationGroup",n.Vv),this.stopAtFrame=this.registerDataInput("stopAtFrame",n.Es,-1)}_preparePendingTasks(t){const e=this.animationGroup.getValue(t),i=this.stopAtFrame.getValue(t)??-1,n=t._getGlobalContextVariable("pendingStopAnimations",[]);n.push({uniqueId:e.uniqueId,stopAtFrame:i}),t._setGlobalContextVariable("pendingStopAnimations",n)}_cancelPendingTasks(t){const e=this.animationGroup.getValue(t),i=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let n=0;n<i.length;n++)if(i[n].uniqueId===e.uniqueId){i.splice(n,1),t._setGlobalContextVariable("pendingStopAnimations",i);break}}_execute(t){const e=this.animationGroup.getValue(t),i=this.stopAtFrame.getValue(t)??-1;return e?isNaN(i)?this._reportError(t,"Invalid stop time."):(i>0?this._startPendingTasks(t):this._stopAnimation(e,t),void this.out._activateSignal(t)):(a.V.Warn("No animation group provided to stop."),this._reportError(t,"No animation group provided to stop."))}_executeOnTick(t){const e=this.animationGroup.getValue(t),i=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let n=0;n<i.length;n++)if(i[n].uniqueId===e.uniqueId&&e.getCurrentFrame()>=i[n].stopAtFrame){this._stopAnimation(e,t),i.splice(n,1),t._setGlobalContextVariable("pendingStopAnimations",i),this.done._activateSignal(t),t._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(t,e){const i=e._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),n=i.indexOf(t.uniqueId);-1!==n&&(t.stop(),i.splice(n,1),e._setGlobalContextVariable("currentlyRunningAnimationGroups",i))}}(0,o.Y5)("FlowGraphStopAnimationBlock",r)}}]);