(()=>{var e,t,r={6221:()=>{},14590:(e,t,r)=>{"use strict";r.d(t,{p:()=>p});
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const n=Symbol("Comlink.proxy"),a=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),i=Symbol("Comlink.finalizer"),s=Symbol("Comlink.thrown"),c=e=>"object"==typeof e&&null!==e||"function"==typeof e,l={canHandle:e=>c(e)&&e[n],serialize(e){const{port1:t,port2:r}=new MessageChannel;return p(e,t),[r,[r]]},deserialize:e=>(e.start(),function(e,t){const r=new Map;return e.addEventListener("message",function(e){const{data:t}=e;if(!t||!t.id)return;const n=r.get(t.id);if(n)try{n(t)}finally{r.delete(t.id)}}),h(e,r,[],t)}(e))},u=new Map([["proxy",l],["throw",{canHandle:e=>c(e)&&s in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function p(e,t=globalThis,r=["*"]){t.addEventListener("message",function a(o){if(!o||!o.data)return;if(!function(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}(r,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:c,type:l,path:u}=Object.assign({path:[]},o.data),m=(o.data.argumentList||[]).map(x);let g;try{const t=u.slice(0,-1).reduce((e,t)=>e[t],e),r=u.reduce((e,t)=>e[t],e);switch(l){case"GET":g=r;break;case"SET":t[u.slice(-1)[0]]=x(o.data.value),g=!0;break;case"APPLY":g=r.apply(t,m);break;case"CONSTRUCT":g=function(e){return Object.assign(e,{[n]:!0})}(new r(...m));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;p(e,r),g=function(e,t){return v.set(e,t),e}(t,[t])}break;case"RELEASE":g=void 0;break;default:return}}catch(e){g={value:e,[s]:0}}Promise.resolve(g).catch(e=>({value:e,[s]:0})).then(r=>{const[n,o]=w(r);t.postMessage(Object.assign(Object.assign({},n),{id:c}),o),"RELEASE"===l&&(t.removeEventListener("message",a),f(t),i in e&&"function"==typeof e[i]&&e[i]())}).catch(e=>{const[r,n]=w({value:new TypeError("Unserializable return value"),[s]:0});t.postMessage(Object.assign(Object.assign({},r),{id:c}),n)})}),t.start&&t.start()}function f(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function m(e){if(e)throw new Error("Proxy has been released and is not useable")}function g(e){return S(e,new Map,{type:"RELEASE"}).then(()=>{f(e)})}const d=new WeakMap,b="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(d.get(e)||0)-1;d.set(e,t),0===t&&g(e)});function h(e,t,r=[],n=function(){}){let i=!1;const s=new Proxy(n,{get(n,a){if(m(i),a===o)return()=>{!function(e){b&&b.unregister(e)}(s),g(e),t.clear(),i=!0};if("then"===a){if(0===r.length)return{then:()=>s};const n=S(e,t,{type:"GET",path:r.map(e=>e.toString())}).then(x);return n.then.bind(n)}return h(e,t,[...r,a])},set(n,a,o){m(i);const[s,c]=w(o);return S(e,t,{type:"SET",path:[...r,a].map(e=>e.toString()),value:s},c).then(x)},apply(n,o,s){m(i);const c=r[r.length-1];if(c===a)return S(e,t,{type:"ENDPOINT"}).then(x);if("bind"===c)return h(e,t,r.slice(0,-1));const[l,u]=y(s);return S(e,t,{type:"APPLY",path:r.map(e=>e.toString()),argumentList:l},u).then(x)},construct(n,a){m(i);const[o,s]=y(a);return S(e,t,{type:"CONSTRUCT",path:r.map(e=>e.toString()),argumentList:o},s).then(x)}});return function(e,t){const r=(d.get(t)||0)+1;d.set(t,r),b&&b.register(e,t,e)}(s,e),s}function y(e){const t=e.map(w);return[t.map(e=>e[0]),(r=t.map(e=>e[1]),Array.prototype.concat.apply([],r))];var r}const v=new WeakMap;function w(e){for(const[t,r]of u)if(r.canHandle(e)){const[n,a]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},v.get(e)||[]]}function x(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function S(e,t,r,n){return new Promise(a=>{const o=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(o,a),e.start&&e.start(),e.postMessage(Object.assign({id:o},r),n)})}},64150:()=>{},79696:()=>{},84218:(e,t,r)=>{"use strict";var n=r(14670),a=r(71587),o=r(14590),i=r(61625),s=r(29849),c=r(45565),l=r(42812),u=r(12221),p=r(20038),f=r(71069),m=r(75202),g=r(27649),d=r(27933),b=r(97416),h=r(10678),y=r(47092);const v={bilinear:n.A,replicate:a.A},w={Uint8Array,Uint16Array,Int16Array,Float32Array,Uint32Array};function x(e,t,r,n){const a=void 0!==e.pixelRepresentation&&1===e.pixelRepresentation,o=a&&void 0!==e.bitsStored?32-e.bitsStored:void 0;if(a&&void 0!==o)for(let t=0;t<e.pixelData.length;t++)e.pixelData[t]=e.pixelData[t]<<o>>o;let i=e.pixelData;e.pixelDataLength=e.pixelData.length;const{min:s,max:c}=(0,b.A)(e.pixelData),l=void 0===t.allowFloatRendering||t.allowFloatRendering;let u=(0,y.A)(e.photometricInterpretation)&&void 0===t.targetBuffer?.offset;const p=t.preScale?.enabled,f=p&&Object.values(t.preScale.scalingParameters).some(e=>"number"==typeof e&&!Number.isInteger(e)),m=!t.preScale.enabled||!l&&f,g=t.targetBuffer?.type;if(g&&t.preScale.enabled&&!m){const e=A(s,c,t.preScale.scalingParameters);u=!(0,h.r)(e.min,e.max,w[g])}i=g&&!u?function(e,t,r,n){const{arrayBuffer:a,type:o,offset:i=0,length:s,rows:c}=e.targetBuffer,l=r[o];if(!l)throw new Error(`target array ${o} is not supported, or doesn't exist.`);c&&c!=t.rows&&function(e,t,r){const n=function(e,t,r){const{samplesPerPixel:n}=e,{rows:a,columns:o}=t,i=a*o*n,s=new r(i),c=s.byteLength/i;return{pixelData:s,rows:a,columns:o,frameInfo:{...e.frameInfo,rows:a,columns:o},imageInfo:{...e.imageInfo,rows:a,columns:o,bytesPerPixel:c}}}(e,t,r),{scalingType:a="replicate"}=t;v[a](e,n),Object.assign(e,n),e.pixelDataLength=e.pixelData.length}(t,e.targetBuffer,l);const u=t.pixelDataLength,p=i,f=null!=s?s:u-p,m=t.pixelData;if(f!==m.length)throw new Error(`target array for image does not have the same length (${f}) as the decoded image length (${m.length}).`);const g=a?new l(a,p,f):new l(f);return g.set(m,0),n=g,n}(t,e,w,i):t.preScale.enabled&&!m?function(e,t,r,n){const a=e.preScale.scalingParameters;E(a);const o=A(t,r,a);return S(o.min,o.max,n)}(t,s,c,e):S(s,c,e);let x=s,P=c;if(t.preScale.enabled&&!m){const r=t.preScale.scalingParameters;E(r);const n=function(e){const{rescaleSlope:t,rescaleIntercept:r,modality:n,doseGridScaling:a,suvbw:o}=e,i="RTDOSE"===n&&"number"==typeof a,s="PT"===n&&"number"==typeof o;return"number"==typeof t&&"number"==typeof r||i||s}(r);if(n){(0,d.A)(i,r),e.preScale={...t.preScale,scaled:!0};const n=A(s,c,r);x=n.min,P=n.max}}else m&&(e.preScale={enabled:!0,scaled:!1},x=s,P=c);e.pixelData=i,e.smallestPixelValue=x,e.largestPixelValue=P;const k=(new Date).getTime();return e.decodeTimeInMS=k-r,e}function S(e,t,r){const n=new((0,h.A)(e,t))(r.pixelData.length);return n.set(r.pixelData,0),n}function A(e,t,r){const{rescaleSlope:n,rescaleIntercept:a,modality:o,doseGridScaling:i,suvbw:s}=r;return"PT"!==o||"number"!=typeof s||isNaN(s)?"RTDOSE"!==o||"number"!=typeof i||isNaN(i)?"number"==typeof n&&"number"==typeof a?{min:n*e+a,max:n*t+a}:{min:e,max:t}:{min:e*i,max:t*i}:{min:s*(e*n+a),max:s*(t*n+a)}}function E(e){if(!e)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}const P={decodeTask:({imageFrame:e,transferSyntax:t,decodeConfig:r,options:n,pixelData:a,callbackFn:o})=>async function(e,t,r,n,a,o){const d=(new Date).getTime();let b,h=null;switch(t){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":case"1.2.840.10008.1.2.1.99":h=(0,i.A)(e,r);break;case"1.2.840.10008.1.2.2":h=(0,s.A)(e,r);break;case"1.2.840.10008.1.2.5":h=(0,c.A)(e,r);break;case"1.2.840.10008.1.2.4.50":b={...e},h=(0,l.A)(r,b);break;case"1.2.840.10008.1.2.4.51":h=(0,u.A)(e,r);break;case"1.2.840.10008.1.2.4.57":case"1.2.840.10008.1.2.4.70":h=(0,p.A)(e,r);break;case"1.2.840.10008.1.2.4.80":case"1.2.840.10008.1.2.4.81":b={signed:1===e.pixelRepresentation,bytesPerPixel:e.bitsAllocated<=8?1:2,...e},h=(0,f.A)(r,b);break;case"1.2.840.10008.1.2.4.90":case"1.2.840.10008.1.2.4.91":b={...e},h=(0,m.A)(r,b);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":b={...e},h=(0,g.A)(r,b);break;default:throw new Error(`no decoder for transfer syntax ${t}`)}if(!h)throw new Error("decodePromise not defined");const y=x(await h,a,d);return o?.(y),y}(e,t,a,0,n,o)};(0,o.p)(P)},94304:()=>{}},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,a),o.exports}a.m=r,a.x=()=>{var e=a.O(void 0,[1612],()=>a(84218));return e=a.O(e)},e=[],a.O=(t,r,n,o)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,n,o]=e[u],s=!0,c=0;c<r.length;c++)(!1&o||i>=o)&&Object.keys(a.O).every(e=>a.O[e](r[c]))?r.splice(c--,1):(s=!1,o<i&&(i=o));if(s){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[r,n,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,r)=>(a.f[r](e,t),t),[])),a.u=e=>e+".bundle.js",a.miniCssF=e=>{},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{a.b=self.location+"";var e={9921:1};a.f.i=(t,r)=>{e[t]||importScripts(a.p+a.u(t))};var t=self.webpackChunkeverything_viewer=self.webpackChunkeverything_viewer||[],r=t.push.bind(t);t.push=t=>{var[n,o,i]=t;for(var s in o)a.o(o,s)&&(a.m[s]=o[s]);for(i&&i(a);n.length;)e[n.pop()]=1;r(t)}})(),t=a.x,a.x=()=>a.e(1612).then(t);a.x()})();